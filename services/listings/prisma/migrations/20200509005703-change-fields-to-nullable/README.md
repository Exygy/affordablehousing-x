# Migration `20200509005703-change-fields-to-nullable`

This migration has been generated by Marcin Jedras at 5/9/2020, 12:57:03 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Address" ALTER COLUMN "city" DROP NOT NULL,
ALTER COLUMN "county" DROP NOT NULL,
ALTER COLUMN "latitude" DROP NOT NULL,
ALTER COLUMN "longitude" DROP NOT NULL,
ALTER COLUMN "state" DROP NOT NULL,
ALTER COLUMN "street" DROP NOT NULL,
ALTER COLUMN "zipCode" DROP NOT NULL;

ALTER TABLE "public"."Attachment" ALTER COLUMN "fileUrl" DROP NOT NULL,
ALTER COLUMN "label" DROP NOT NULL;

ALTER TABLE "public"."Listing" DROP CONSTRAINT IF EXiSTS "Listing_applicationAddressId_fkey",
DROP CONSTRAINT IF EXiSTS "Listing_buildingAddressId_fkey",
DROP CONSTRAINT IF EXiSTS "Listing_leasingAgentAddressId_fkey",
ALTER COLUMN "acceptingApplicationsAtLeasingAgent" DROP NOT NULL,
ALTER COLUMN "acceptingApplicationsByPoBox" DROP NOT NULL,
ALTER COLUMN "acceptingOnlineApplications" DROP NOT NULL,
ALTER COLUMN "acceptsPostmarkedApplications" DROP NOT NULL,
ALTER COLUMN "accessibility" DROP NOT NULL,
ALTER COLUMN "amenities" DROP NOT NULL,
ALTER COLUMN "applicationAddressId" DROP NOT NULL,
ALTER COLUMN "applicationDueDate" DROP NOT NULL,
ALTER COLUMN "applicationFee" DROP NOT NULL,
ALTER COLUMN "applicationOpenDate" DROP NOT NULL,
ALTER COLUMN "applicationOrganization" DROP NOT NULL,
ALTER COLUMN "blankPaperApplicationCanBePickedUp" DROP NOT NULL,
ALTER COLUMN "buildingAddressId" DROP NOT NULL,
ALTER COLUMN "buildingSelectionCriteria" DROP NOT NULL,
ALTER COLUMN "buildingTotalUnits" DROP NOT NULL,
ALTER COLUMN "costsNotIncluded" DROP NOT NULL,
ALTER COLUMN "creditHistory" DROP NOT NULL,
ALTER COLUMN "criminalBackground" DROP NOT NULL,
ALTER COLUMN "depositMax" DROP NOT NULL,
ALTER COLUMN "depositMin" DROP NOT NULL,
ALTER COLUMN "developer" DROP NOT NULL,
ALTER COLUMN "disableUnitsAccordion" DROP NOT NULL,
ALTER COLUMN "imageUrl" DROP NOT NULL,
ALTER COLUMN "leasingAgentAddressId" DROP NOT NULL,
ALTER COLUMN "leasingAgentEmail" DROP NOT NULL,
ALTER COLUMN "leasingAgentName" DROP NOT NULL,
ALTER COLUMN "leasingAgentOfficeHours" DROP NOT NULL,
ALTER COLUMN "leasingAgentPhone" DROP NOT NULL,
ALTER COLUMN "leasingAgentTitle" DROP NOT NULL,
ALTER COLUMN "name" DROP NOT NULL,
ALTER COLUMN "neighborhood" DROP NOT NULL,
ALTER COLUMN "petPolicy" DROP NOT NULL,
ALTER COLUMN "postmarkedApplicationsReceivedByDate" DROP NOT NULL,
ALTER COLUMN "programRules" DROP NOT NULL,
ALTER COLUMN "rentalHistory" DROP NOT NULL,
ALTER COLUMN "requiredDocuments" DROP NOT NULL,
ALTER COLUMN "smokingPolicy" DROP NOT NULL,
ALTER COLUMN "unitAmenities" DROP NOT NULL,
ALTER COLUMN "unitsAvailable" DROP NOT NULL,
ALTER COLUMN "urlSlug" DROP NOT NULL,
ALTER COLUMN "waitlistCurrentSize" DROP NOT NULL,
ALTER COLUMN "waitlistMaxSize" DROP NOT NULL,
ALTER COLUMN "yearBuilt" DROP NOT NULL;

ALTER TABLE "public"."Preference" ALTER COLUMN "description" DROP NOT NULL,
ALTER COLUMN "links" DROP NOT NULL,
ALTER COLUMN "ordinal" DROP NOT NULL,
ALTER COLUMN "subtitle" DROP NOT NULL,
ALTER COLUMN "title" DROP NOT NULL;

ALTER TABLE "public"."Unit" ALTER COLUMN "amiChartId" DROP NOT NULL,
ALTER COLUMN "amiPercentage" DROP NOT NULL,
ALTER COLUMN "annualIncomeMax" DROP NOT NULL,
ALTER COLUMN "annualIncomeMin" DROP NOT NULL,
ALTER COLUMN "floor" DROP NOT NULL,
ALTER COLUMN "maxOccupancy" DROP NOT NULL,
ALTER COLUMN "minOccupancy" DROP NOT NULL,
ALTER COLUMN "monthlyIncomeMin" DROP NOT NULL,
ALTER COLUMN "monthlyRent" DROP NOT NULL,
ALTER COLUMN "monthlyRentAsPercentOfIncome" DROP NOT NULL,
ALTER COLUMN "numBathrooms" DROP NOT NULL,
ALTER COLUMN "numBedrooms" DROP NOT NULL,
ALTER COLUMN "number" DROP NOT NULL,
ALTER COLUMN "priorityType" DROP NOT NULL,
ALTER COLUMN "reservedType" DROP NOT NULL,
ALTER COLUMN "sqFeet" DROP NOT NULL,
ALTER COLUMN "status" DROP NOT NULL,
ALTER COLUMN "unitType" DROP NOT NULL;

ALTER TABLE "public"."Listing" ADD FOREIGN KEY ("applicationAddressId")REFERENCES "public"."Address"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Listing" ADD FOREIGN KEY ("buildingAddressId")REFERENCES "public"."Address"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Listing" ADD FOREIGN KEY ("leasingAgentAddressId")REFERENCES "public"."Address"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200508225838-initial..20200509005703-change-fields-to-nullable
--- datamodel.dml
+++ datamodel.dml
@@ -1,123 +1,123 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
 }
 model Listing {
   id                                   String       @default(uuid()) @id
-  acceptingApplicationsAtLeasingAgent  Boolean
-  acceptingApplicationsByPoBox         Boolean
-  acceptingOnlineApplications          Boolean
-  acceptsPostmarkedApplications        Boolean
-  accessibility                        String
-  amenities                            String
-  applicationDueDate                   String
-  applicationOpenDate                  String
-  applicationFee                       String
-  applicationOrganization              String
-  applicationAddress                   Address      @relation("applicationAddress", fields: [applicationAddressId], references: [id])
-  applicationAddressId                 String
+  acceptingApplicationsAtLeasingAgent  Boolean?
+  acceptingApplicationsByPoBox         Boolean?
+  acceptingOnlineApplications          Boolean?
+  acceptsPostmarkedApplications        Boolean?
+  accessibility                        String?
+  amenities                            String?
+  applicationDueDate                   String?
+  applicationOpenDate                  String?
+  applicationFee                       String?
+  applicationOrganization              String?
+  applicationAddress                   Address?      @relation("applicationAddress", fields: [applicationAddressId], references: [id])
+  applicationAddressId                 String?
   attachments                          Attachment[]
-  blankPaperApplicationCanBePickedUp   Boolean
-  buildingAddress                      Address      @relation("buildingAddress", fields: [buildingAddressId], references: [id])
-  buildingAddressId                    String
-  buildingTotalUnits                   Int
-  buildingSelectionCriteria            String
-  costsNotIncluded                     String
-  creditHistory                        String
-  criminalBackground                   String
-  depositMin                           String
-  depositMax                           String
-  developer                            String
-  disableUnitsAccordion                Boolean
-  imageUrl                             String
-  leasingAgentAddress                  Address      @relation("leasingAgentAddress", fields: [leasingAgentAddressId], references: [id])
-  leasingAgentAddressId                String
-  leasingAgentEmail                    String
-  leasingAgentName                     String
-  leasingAgentOfficeHours              String
-  leasingAgentPhone                    String
-  leasingAgentTitle                    String
-  name                                 String
-  neighborhood                         String
+  blankPaperApplicationCanBePickedUp   Boolean?
+  buildingAddress                      Address?      @relation("buildingAddress", fields: [buildingAddressId], references: [id])
+  buildingAddressId                    String?
+  buildingTotalUnits                   Int?
+  buildingSelectionCriteria            String?
+  costsNotIncluded                     String?
+  creditHistory                        String?
+  criminalBackground                   String?
+  depositMin                           String?
+  depositMax                           String?
+  developer                            String?
+  disableUnitsAccordion                Boolean?
+  imageUrl                             String?
+  leasingAgentAddress                  Address?      @relation("leasingAgentAddress", fields: [leasingAgentAddressId], references: [id])
+  leasingAgentAddressId                String?
+  leasingAgentEmail                    String?
+  leasingAgentName                     String?
+  leasingAgentOfficeHours              String?
+  leasingAgentPhone                    String?
+  leasingAgentTitle                    String?
+  name                                 String?
+  neighborhood                         String?
   preferences                          Preference[]
-  petPolicy                            String
-  postmarkedApplicationsReceivedByDate String
-  programRules                         String
-  rentalHistory                        String
-  requiredDocuments                    String
-  smokingPolicy                        String
+  petPolicy                            String?
+  postmarkedApplicationsReceivedByDate String?
+  programRules                         String?
+  rentalHistory                        String?
+  requiredDocuments                    String?
+  smokingPolicy                        String?
   units                                Unit[]
-  unitsAvailable                       Int
-  unitAmenities                        String
+  unitsAvailable                       Int?
+  unitAmenities                        String?
   // unitsSummarized                       UnitsSummarized
-  urlSlug                              String
-  waitlistCurrentSize                  Int
-  waitlistMaxSize                      Int
-  yearBuilt                            Int
+  urlSlug                              String?
+  waitlistCurrentSize                  Int?
+  waitlistMaxSize                      Int?
+  yearBuilt                            Int?
 }
 model Unit {
   id                           String   @default(uuid()) @id
-  amiPercentage                String
-  annualIncomeMin              String
-  monthlyIncomeMin             Float
-  floor                        Int
-  annualIncomeMax              String
-  maxOccupancy                 Int
-  minOccupancy                 Int
-  monthlyRent                  Float
-  numBathrooms                 Int
-  numBedrooms                  Int
-  number                       String
-  priorityType                 String
-  reservedType                 String
-  sqFeet                       Float
-  status                       String
-  unitType                     String
+  amiPercentage                String?
+  annualIncomeMin              String?
+  monthlyIncomeMin             Float?
+  floor                        Int?
+  annualIncomeMax              String?
+  maxOccupancy                 Int?
+  minOccupancy                 Int?
+  monthlyRent                  Float?
+  numBathrooms                 Int?
+  numBedrooms                  Int?
+  number                       String?
+  priorityType                 String?
+  reservedType                 String?
+  sqFeet                       Float?
+  status                       String?
+  unitType                     String?
   createdAt                    DateTime @default(now())
   updatedAt                    DateTime @updatedAt
-  amiChartId                   Int
-  monthlyRentAsPercentOfIncome Int
+  amiChartId                   Int?
+  monthlyRentAsPercentOfIncome Int?
   listing                      Listing  @relation(fields: [listingId], references: [id])
   listingId                    String
 }
 model Attachment {
   id        String         @default(uuid()) @id
-  label     String
-  fileUrl   String
+  label     String?
+  fileUrl   String?
   type      AttachmentType
   listing   Listing        @relation(fields: [listingId], references: [id])
   listingId String
 }
 model Address {
   id                  String   @default(uuid()) @id
-  city                String
-  county              String
-  state               String
-  street              String
-  zipCode             String
-  latitude            Float
-  longitude           Float
+  city                String?
+  county              String?
+  state               String?
+  street              String?
+  zipCode             String?
+  latitude            Float?
+  longitude           Float?
   leasingAgentAddress Listing? @relation("leasingAgentAddress")
   buildingAddress     Listing? @relation("buildingAddress")
   applicationAddress  Listing? @relation("applicationAddress")
 }
 model Preference {
   id          String  @default(uuid()) @id
-  ordinal     String
-  title       String
-  subtitle    String
-  description String
-  links       Json
+  ordinal     String?
+  title       String?
+  subtitle    String?
+  description String?
+  links       Json?
   listing     Listing @relation(fields: [listingId], references: [id])
   listingId   String
 }
```


